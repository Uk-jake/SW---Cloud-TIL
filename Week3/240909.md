# 오늘 배운 것
- **주요 개념**: 네트워크(NAT, ACL), Linux 사용자 관리, 그룹 관리
- **구체적인 내용**
    - NAT
    - ACL : 표준 ACL, 확장 ACL
    - 사용자 관리
    - 그룹 관리 명령
    - 사용자 정보 관리

# 상세 학습 내용
## NAT(네트워크 주소 변환)

내부 네트워크에서 외부 네트워크로 접속하기 위해서는 Private IP가 아닌 Public IP 주소가 필요합니다.

- **Private IP**: 내부 네트워크에서 컴퓨터를 구분하기 위한 IP
    - 10.0.0.0 ~ 10.255.255.255
    - 172.16.0.0 ~ 172.31.255.255
    - 192.168.0.0 ~ 192.168.255.255

### NAT의 사용 목적
- **IP 주소 절감**: 제한된 Public IP 주소를 활용하여 더 많은 내부 컴퓨터가 인터넷을 사용할 수 있도록 합니다.
- **보안 강화**: 외부에서 내부 네트워크의 컴퓨터에 직접 접근할 수 없도록 IP 주소를 숨깁니다.

### Dynamic NAT
- **동적 IP 주소 할당 방식**: 네트워크 장비가 내부 네트워크에서 외부 네트워크로 나갈 때, IP pool에서 동적으로 IP 주소를 할당해 변환합니다.
- 단점: Dynamic NAT만으로는 서버 역할을 할 수 없습니다. 내부 컴퓨터가 외부에서 서버 역할을 하기 위해서는 다른 방식이 필요합니다.

### PAT (Port Address Translation) 또는 오버로딩
- **Dynamic NAT의 한계를 보완**: 단순 Dynamic NAT만으로는 Public IP 절감 효과가 미비하여 사용.
- 내부 네트워크의 컴퓨터를 구분하기 위해 **IP와 Port 번호**를 함께 사용합니다. 이를 통해 더 많은 컴퓨터가 동시에 인터넷을 사용할 수 있습니다.
- **NAT Overload** 또는 **PAT**라고도 불립니다.
- **포트 번호**: 0 ~ 65535 (0번과 65535번은 사용 불가)
    - 1 ~ 1024: 알려진 포트 번호 (well-known ports).

### NAT 환경에서 내부 컴퓨터를 서버로 사용하는 방법
- 네트워크 장비에서 외부 IP와 Port를 내부 장비의 IP와 Port로 **고정 변환**하도록 설정해야 합니다.
- 이 설정을 통해 외부에서 내부 네트워크의 특정 컴퓨터에 접속할 수 있습니다.

---

## Access List(ACL, 접근 제어 목록)

ACL은 라우터 또는 컴퓨터를 통과하는 트래픽 중에서 불필요하거나 악성 트래픽을 차단하기 위한 규칙 목록입니다.

### ACL의 종류
1. **Standard Access List**: 출발지 IP 주소를 기준으로 트래픽을 허용 또는 차단.
2. **Extended Access List**: 출발지 IP, 목적지 IP, 프로토콜, 포트 번호 등 여러 기준으로 트래픽을 제어.

### 허용 여부
- **permit**: 트래픽을 허용.
- **deny**: 트래픽을 차단.

### ACL 구성 요소
- **ACL 번호 또는 이름**: 규칙을 구분하는 식별자.
    - Standard ACL은 1~99, Extended ACL은 100~199 번호를 사용.
- **트래픽 제어**: 특정 트래픽을 허용할지 차단할지 결정.
- **출발지/목적지 IP 주소**: 트래픽의 출발지와 목적지 주소.
- **프로토콜 및 포트 번호**: TCP, UDP, IP 등 프로토콜과 포트 번호를 기준으로 트래픽을 필터링.

### Standard Access List 예시
- 11.1.1.0/24 네트워크에서 11.1.1.1 컴퓨터만 허용하고, 나머지는 모두 거부한 후 다른 네트워크는 모두 허용하는 ACL 규칙.

```bash
# 11.1.1.1 IP에서 오는 트래픽을 허용
access-list 10 permit 11.1.1.1

# 11.1.1.0/24 네트워크에서 오는 모든 트래픽을 거부
access-list 10 deny 11.1.1.0 0.0.0.255

# 그 외 모든 네트워크 트래픽은 허용
access-list 10 permit any
```

### Extended Access List 예시
- 11.1.1.0/24 네트워크에서 11.1.2.0/24 네트워크로 향하는 20번 포트를 거부.

```bash
access-list 100 deny tcp 11.1.1.0 0.0.0.255 11.1.2.0 0.0.0.255 eq 20
access-list 100 permit ip any any
```

---

## ACL 차이점

| **특징** | **Extended ACL** | **Standard ACL** |
| --- | --- | --- |
| **번호 범위** | 100~199, 2000~2699 | 1~99, 1300~1999 |
| **필터링 기준** | 출발지/목적지 IP, 프로토콜, 포트 | 출발지 IP만 |
| **세부 제어** | 복잡한 필터링 가능 | 단순한 트래픽 제어 |
| **사용 용도** | 복잡한 네트워크 정책 | 간단한 트래픽 제어 |

---

## 주요 프로토콜과 포트 번호

| **프로토콜** | **포트 번호** | **설명** |
| --- | --- | --- |
| **HTTP/HTTPS** | 80, 443 | 웹 브라우징 |
| **FTP** | 20, 21 | 파일 전송 프로토콜 |
| **SSH** | 22 | 보안 원격 접속 |
| **DNS** | 53 | 도메인 이름 변환 |
| **SMTP** | 25, 465, 587 | 이메일 전송 |
| **RDP** | 3389 | 원격 데스크톱 접속 |

---

## Ubuntu 사용자 관리

### 사용자 계정 관련 파일
1. **`/etc/passwd`**: 사용자 계정 정보가 저장된 파일.
    - 형식: 로그인 ID : x : UID : GID : 설명 : 홈디렉토리 : 로그인 쉘.
    - UID: 사용자를 구분하는 번호로, 일반 사용자는 1000번부터 할당.
    - GID: 사용자가 속한 그룹의 ID.
    
2. **`/etc/shadow`**: 사용자 암호 정보를 저장한 파일.
    - 암호는 **단방향 암호화**로 저장됩니다.
    
3. **`/etc/group`**: 그룹 정보가 저장된 파일.

---

## 계정 관리 명령어

1. **`useradd`**: 사용자 계정 생성 명령어.
    - 주요 옵션: 
        - `-s`: 로그인 쉘 지정.
        - `-m`: 홈 디렉토리 생성.
        - `-u`: UID 지정.
        - `-G`: 추가 그룹 지정.

2. **`adduser`**: `useradd`보다 편리한 계정 생성 명령어. 대화형 방식으로 계정을 추가.

3. **`usermod`**: 계정 수정 명령어.
    - 주요 옵션:
        - `-l`: 사용자 이름 변경.
        - `-d`: 홈 디렉토리 경로 변경.
        - `-g`: 기본 그룹 변경.
        - `-G`: 추가 그룹 설정.

4. **`userdel`**: 사용자 계정 삭제.
    - `-r` 옵션으로 홈 디렉토리까지 삭제 가능.

---

## 패스워드 에이징
- 비밀번호의 유효 기간 설정을 통해 보안 위협을 줄이고, 시스템의 안전성을 높입니다.
    - **최대/최소 사용 기간**: `useradd`나 `usermod`, `passwd` 명령어로 설정 가능.
    - **경고일 및 만료일**: `chage` 명령어로 설정 가능.

---

## 그룹 관리 명령어

1. **그룹 생성**
    - `groupadd [옵션] 그룹이름`: 그룹을 생성합니다.
    - `addgroup`: 대화형 그룹 생성.

2. **그룹 수정**
    - `groupmod`: 그룹 아이디나 이름을 변경.

3. **그룹 삭제**
    - `groupdel 그룹이름`: 그룹 삭제.

4. **그룹 암호 설정**
    - `gpasswd 그룹이름`: 그룹에 암호를 설정하고, 사용자를 추가하거나 삭제할 수 있습니다.

---

## 사용자 정보 관리

### UID와 EUID
- **UID**: 사용자가 로그인할 때 사용한 계정의 UID.
- **EUID**: 현재 명령을 실행하는 주체의 UID.
    - 보통은 UID와 EUID가 일치하지만, 특정 상황에서 다를 수 있습니다. 예: `su` 명령을 통해 계정을 변경한 경우.

---

## 실습 예시

1. **test01, test02 계정 생성**

```bash
sudo useradd -u 2100 -G 3 -s /bin/sh -m -c "test01.user" test01
sudo useradd -u 2200 -G 4 -s /usr/bin/bash -m -c "test02.user" test02
```

2. **adduser 명령으로 test03 계정 생성**

```bash
sudo add

user --uid 2300 --shell /usr/bin/bash --gecos "test03.user" test03
```

3. **패스워드 에이징 설정**

```bash
sudo chage -m 4 -M 200 -W 10 -I 5 -E 2024-12-09 test01
```

4. **test03 계정 이름 및 UID 변경**

```bash
sudo usermod -u 2010 -l test33 test03
```

5. **test02 계정 및 홈 디렉토리 삭제**

```bash
sudo userdel -r test02
```

---

이와 같이 내가 학습한 내용을 정리했으며, 표현을 자연스럽게 통일했습니다. 더 궁금한 점이 있으면 언제든지 물어보세요!

    
## 참고 자료
- 

## 배운 점 & 느낀 점
- Linux를 이용하여 Public 클라우드를 만들 때, 계정마다 원하는 기능을 부여할 수 있다는 것을 알게되었다. 

## 내일의 목표
- 서버 세팅해보기